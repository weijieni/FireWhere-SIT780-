<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Index</title>

    <!-- Compiled and minified CSS -->

    <!-- Materialize icons-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Awsome font -->
    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" rel="stylesheet">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.1/bootstrap-table.js"></script>
    <script src="/socket.io/socket.io.js"></script>
</head>

<!-- <link href="style.sass" rel="stylesheet"> -->
<link href="styles.css" rel="stylesheet">

<body>
    <div class="container_main flex">
        <!-- side nav bar -->
        <div class="navsection">
            <header class="flex" style="justify-content: center; align-items: center;">
                <a id="navwelcome" href="#" onclick="handleTab('#welcome', '#navwelcome')"><img
                        src="assets/logo.png" /></a>
            </header>
            <ul class="navcontent">
                <li><button id="navbutton_1" class="navbutton" onclick="handleTab('#overview', '#navbutton_1')"><img
                            class="btn_icon" src="assets/map.png" />Overview</button></li>
                <li>
                    <a href="#" class="li_a" id="nav_dev"><img class="btn_icon" src="assets/predict.png" />Conditional
                        Prediction</a>
                    <div class="nav_box" id="dev_item" style="display: none;">
                        <button id="navbutton_2" onclick="handleTab('#temperature', '#navbutton_2')"
                            class="nav_item navbutton"><img class="btn_icon"
                                src="assets/tempereture.png" />Temperature</button>
                        <button id="navbutton_3" onclick="handleTab('#humidity', '#navbutton_3')"
                            class="nav_item navbutton"><img class="btn_icon"
                                src="assets/humidity.png" />Humidity</button>
                        <button id="navbutton_4" onclick="handleTab('#season', '#navbutton_4')"
                            class="nav_item navbutton"><img class="btn_icon" src="assets/season.png" />Season</button>
                    </div>
                </li>
                <!-- <li><button id="navbutton_5" class="navbutton" onclick="handleTab('#warning', '#navbutton_5')"><img
                            class="btn_icon" src="assets/warning.png" />Warnings</button></li> -->
                <!-- <li><button id="navbutton_6" class="navbutton" onclick="handleTab('#data', '#navbutton_6')"><img
                            class="btn_icon" src="assets/data.png" />Data</button></li> -->
                <li><button id="navbutton_7" class="navbutton" onclick="handleTab('#research', '#navbutton_7')"><img
                            class="btn_icon" src="assets/research.png" />Research</button></li>
                <li><button id="navbutton_8" class="navbutton" onclick="handleTab('#signup', '#navbutton_8')"><img
                            class="btn_icon" src="assets/signup.png" />Sign up</button></li>
                <!-- <li><button id="navbutton_9" class="navbutton" onclick="handleTab('#chat', '#navbutton_9')"><img
                            class="btn_icon" src="assets/chat.png" />Chat room</button></li> -->
                <li><button id="navbutton_10" class="navbutton" onclick="handleTab('#login', '#navbutton_10')"><img
                            class="btn_icon" src="assets/admin.png" />Login</button></li>
            </ul>
        </div>

        <!-- tab pages -->
        <div class="mainsection flex" style="flex-direction: column;">
            <nav class="navtop">
                <div style="display: flex; flex-direction: row; align-items: center;">
                    <a href="#" class="nav_icon"><i class="medium material-icons">reorder</i></a>
                    <h5 id="tab_title" style="margin-left: 20px; text-transform: uppercase;">Welcome</h5>
                </div>
                <div style="display: flex; flex-direction: row; align-items: center;">
                    <button type="button" class="rescuebtn breathing" id="breathing" data-bs-toggle="modal" data-bs-target="#exampleModalCenter">
                        RESCUE
                    </button>
                    <button type="button" class="rescuebtn breathing-after" id="breathing-after1" style="background-color: green;display: none;" data-bs-toggle="modal" data-bs-target="#exampleModalCenter">
                        YOU ARE SAFE
                    </button>
                    <img style="min-width: 16px; min-height: 16px; height: 16px; width: 16px;" src="assets/user.png" />
                    <div
                        style="min-width: auto; min-height: 16px; height: 16px; width: auto; padding-left: 12px; padding-right: 12px;">
                        Users on this site: <span id="count">0</span>
                    </div>
                </div>
            </nav>

            <!-- rescue dialog -->
            <div class="modal fade" style="z-index: 9999;" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLongTitle">Rescue Check</h5>
                      <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">
                        <h5>Do you have a safe place to stay?</h5>
                        <p><a id="r1" href="#" role="button" class="btn btn-secondary popover-test" title="Popover title" style="background-color:green;">YES</a></p>
                        <p><a id="r1-checked" href="#" role="button" class="btn btn-secondary popover-test" title="Popover title" style="background-color:red; display:none">NO</a></p>
                        <hr>
                        <h5>Is there any flaming near your house?</h5>
                        <p><a id="r2" href="#" role="button" class="btn btn-secondary popover-test" title="Popover title" style="background-color:green;">NO</a></p>
                        <p><a id="r2-checked" href="#" role="button" class="btn btn-secondary popover-test" title="Popover title" style="background-color:red; display:none">YES</a></p>
                        <hr>
                        <h5>Is there anyone hurt at your home?</h5>
                        <p><a id="r3" href="#" role="button" class="btn btn-secondary popover-test" title="Popover title" style="background-color:green;">NO</a></p>
                        <p><a id="r3-checked" href="#" role="button" class="btn btn-secondary popover-test" title="Popover title" style="background-color:red; display:none">YES</a></p>
                        <div id="rescue-message"></div>
                    </div>
                    <!-- <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                      <button type="button" class="btn btn-primary">Save changes</button>
                    </div> -->
                  </div>
                </div>
            </div>

            <!-- welcome -->
            <div class="pages" id="welcome"
                style="display: flex; flex-direction: column; justify-content: center; align-items: center;">
                <img src="assets/logo2.png" /><br>
                <h2>A bushfire prediction and warning system. Welcome!</h2>
            </div>

            <!-- overview (vertor map) tab -->
            <div class="pages flex" id="overview">
                <div class="map_container" id="map_container">
                    <div id="map"></div>
                    <div id="VIC_content"></div>
                    <div id="NSW_content"></div>
                    <div id="QLD_content"></div>
                    <div id="NT_content"></div>
                    <div id="SA_content"></div>
                    <div id="WA_content"></div>
                    <div id="TAS_content"></div>
                </div>
            </div>

            <!-- conditional prediction tab: temperature subtab -->
            <div class="pages flex" id="temperature">
                <div style="padding: 0 5px;">
                    <table id="temperature_table" data-height="600" data-pagination="true" data-search=”true”>
                        <thead>
                            <tr>
                                <th data-sortable="true" data-field="region">Region</th>
                                <th data-sortable="true" data-field="temperature">Tempereture</th>
                                <th data-sortable="true" data-field="warning">Warning</th>
                                <th data-sortable="true" data-field="urgent">Urgent</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>

            <!-- conditional prediction tab: humidity subtab -->
            <div class="pages flex" id="humidity">
                <div style="padding: 0 5px;">
                    <table id="humidity_table" data-height="600" data-search="true" data-pagination="true">
                        <thead>
                            <tr>
                                <th data-sortable="true" data-field="region" data-title="Region"></th>
                                <th data-sortable="true" data-field="humidity">Humidity</th>
                                <th data-sortable="true" data-field="warning">Warning</th>
                                <th data-sortable="true" data-field="urgent">Urgent</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>

            <!-- conditional prediction tab: season subtab -->
            <div class="pages flex" id="season">
                <div style="padding: 0 5px;">
                    <table id="season_table" data-search="true" data-height="600" data-pagination="true">
                        <thead>
                            <tr>
                                <th data-sortable="true" data-field="region">Region</th>
                                <th data-sortable="true" data-field="season">Season</th>
                                <th data-sortable="true" data-field="warning">Warning</th>
                                <th data-sortable="true" data-field="urgent">Urgent</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>

            <!-- warning tab -->
            <div class="pages flex" id="warning">
                <div style="padding: 0 5px;">
                    <table id="warning_table" data-search="true" data-pagination="true" data-height="600">
                        <thead>
                            <tr>
                                <th data-sortable="true" data-field="region">Region</th>
                                <th data-sortable="true" data-field="warning">Warning</th>
                                <th data-sortable="true" data-field="warning_message" data-formatter="operateFormatter">
                                    Warning Message</th>
                                <th data-sortable="true" data-field="urgent">Urgent</th>
                            </tr>
                        </thead>
                    </table>
                </div>
                <!-- warning message dialog -->
                <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel"
                    aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Warning Message</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body" id="message">
                                Bush fire warning level of your region is: HIGH.
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                <button type="button" class="btn btn-primary" data-bs-dismiss="modal" id="send">Send
                                    SMS</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- data tab -->
            <div class="pages flex" id="data">
                <div class="dropdown dropdown_extra">
                    <label style="margin-right: 10px;">Region</label>
                    <select class="form-select-sm" aria-label="region">
                        <option value="" selected>All</option>
                        <option value="1">New South Wales</option>
                        <option value="2">Queensland</option>
                        <option value="3">South Australia</option>
                        <option value="4">Tasmania</option>
                        <option value="5">Victoria</option>
                        <option value="6">Western Australia</option>
                    </select>
                </div>
                <div class="dropdown dropdown_extra">
                    <label style="margin-right: 10px;">Temperature</label>
                    <select class="form-select-sm" aria-label="Temperature">
                        <option value="" selected>All</option>
                        <option value="1">Below 30℃</option>
                        <option value="2">30℃ - 35℃</option>
                        <option value="3">35℃ - 40℃</option>
                        <option value="4">Exceed 40℃</option>
                    </select>
                </div>
                <div class="dropdown dropdown_extra">
                    <label style="margin-right: 10px;">Humidity</label>
                    <select class="form-select-sm" aria-label="Humidity">
                        <option value="" selected>All</option>
                        <option value="1">Below 30%</option>
                        <option value="2">30% - 70%</option>
                        <option value="3">Exceed 70%</option>
                    </select>
                </div>
                <div class="dropdown dropdown_extra">
                    <label style="margin-right: 10px;">Bush Fire Level</label>
                    <select class="form-select-sm" aria-label="Level">
                        <option value="" selected>All</option>
                        <option value="1">Low-moderate</option>
                        <option value="2">High</option>
                        <option value="3">Very High</option>
                        <option value="4">Severe</option>
                        <option value="5">Extreme</option>
                        <option value="6">Catastrophic</option>
                    </select>
                </div>
                <div class="dropdown dropdown_extra">
                    <label style="margin-right: 10px;">Warning</label>
                    <select class="form-select-sm" aria-label="Warning">
                        <option value="" selected>All</option>
                        <option value="1">Green</option>
                        <option value="2">Blue</option>
                        <option value="3">Yellow</option>
                        <option value="4">Orange</option>
                        <option value="5">Red</option>
                        <option value="6">Code Red</option>
                    </select>
                </div>
                <button type="button" class="btn btn-primary btn_extra">Search</button>
                <button type="button" class="btn btn-secondary btn_extra">Clear</button>
                <div style="padding: 0 5px;">
                    <table id="data_table" data-height="600" data-pagination="true" data-style="border: none">
                        <thead>
                            <tr>
                                <th data-field="region">Region</th>
                                <th data-field="temperature">Temperature</th>
                                <th data-field="humidity">Humidity</th>
                                <th data-field="bushfire_level">Bush Fire Level</th>
                                <th data-field="warning">Warning</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>

            <!-- research tab -->
            <div class="pages" id="research">
                <div class="research_box">
                    <div id="research_cards"></div>
                </div>
            </div>
            <!-- user sign up tab -->
            <div class="pages flex" id="signup">
                <div class="container" style="margin-top: 50px">
                    <h4>Please sign up you details to receive warning messages.</h4><br>
                    <form id="us-form">
						<div class="form-floating mb-3">
                            <input type="text" class="form-control" id="name" placeholder="Name">
                            <label for="floatingInput">Name</label>
                        </div>
						<div class="form-floating mb-3">
                            <input type="text" class="form-control" id="userid" placeholder="User ID">
                            <label for="floatingInput">User ID</label>
                        </div>
						<div class="form-floating mb-3">
                            <input type="password" class="form-control" id="password" placeholder="Password">
                            <label for="floatingInput">Password</label>
                        </div>
						<div class="form-floating mb-3">
                            <input type="password" class="form-control" id="confirmpassword" placeholder="Confirm Password">
                            <label for="floatingInput">Confirm Password</label>
                        </div>
						<div class="form-floating mb-3">
                            <input type="email" class="form-control" id="email" placeholder="E-Mail">
                            <label for="floatingInput">E-Mail ID</label>
                        </div>
                        <div class="form-floating mb-3">
                            <input type="phone" class="form-control" id="phone" placeholder="Phone">
                            <label for="floatingInput">Phone number</label>
                        </div>
                        <div class="form-floating">
                            <input type="region" class="form-control" id="region" placeholder="Region">
                            <label for="floatingRegion">Region</label>
                        </div>
                        <br>
                        <div class="card text-center">
                            <button type="submit" class="btn btn-primary btn-lg" onclick="window.dialog.show();">Sign up
                                Now</button>
                        </div>
                    </form>
                    </form>
                </div>
            </div>

            <!-- Login tab -->
            <div class="pages flex" id="login">
                <div class="container" style="margin-top: 50px">
                    <form id="login-form">
                        <div class="form-floating mb-3">
                            <input type="text" class="form-control" id="username" placeholder="Username">
                            <label for="floatingInput">Username</label>
                        </div>
                        <div class="form-floating">
                            <input type="password" class="form-control" id="passlogin" placeholder="Password">
                            <label for="floatingRegion">Password</label>
                        </div>
                        <br>
                        <div class="card text-center">
                            <button type="submit" class="btn btn-primary btn-lg">Login</button>
                        </div>
                    </form>
                    </form>
                </div>
            </div>

            <!-- Chatbox -->
            <div class="chat-container" id="chatbox" style="display:none;">
                <header class="chat-header">
                    <h3>FireWhere Online Chat</h3>
                </header>
                <main class="chat-main">
                    <div class="chat-messages"></div>
                </main>
                <div class="chat-form-container">
                    <form id="chat-form">
                      <input
                        id="msg"
                        type="text"
                        placeholder="Enter Message"
                        required
                        autocomplete="off"
                      />
                      <button class="btn"><i class="fas fa-paper-plane"></i> Send</button>
                    </form>
                  </div>
            </div>
            <div class="tab_comp">
                <img class="tab_btn bounce" id="chatIcon" src="./assets/messenger.png"/>
            </div>


        </div>
    </div>

    <!-- user details insert -->
    <script>
        const form = document.getElementById('us-form')
        form.addEventListener('submit', registerUser)

        async function registerUser(event) {
            event.preventDefault();
			const name = document.getElementById('name').value;
			const email = document.getElementById('email').value;
			const userid = document.getElementById('userid').value;
			const password = document.getElementById('password').value;
			const role = 'basic';
            const phone = document.getElementById('phone').value;
            const region = document.getElementById('region').value;
			const reqBody = JSON.stringify({
					name,
					email,
					userid,
					password,					
                    phone,
                    region,
					role,
                });
            const result = await fetch('https://firewhere-backend.herokuapp.com/api/adduserdetail', {
                method: 'POST',
                headers: {
                    Accept: 'application/json',
					'Content-Type': 'application/json',
                },
                body: reqBody
            })
			.then((res) => {
			
			return res.json();
			})
            alert(result.message);
        }
    </script>
    <!--login -->
    <script>
        const adminForm = document.getElementById('login-form')
        adminForm.addEventListener('submit', loginUser)

        async function loginUser(event) {
            event.preventDefault()
            const username = document.getElementById('username').value;
            const password = document.getElementById('passlogin').value;

            const result = await fetch('https://firewhere-backend.herokuapp.com/api/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    username,
                    password
                })
            }).then((res) => res.json())
            const { status, message } = result;
            if (status === "ok") {
                window.location.href = '/admin.html'
            }
        }
    </script>

    <!-- fetch data from database -->
    <script>
        // humidity data
        $(humidity_table).bootstrapTable({
            classes: 'table',
            url: 'https://firewhere-backend.herokuapp.com/api/gethumidity'
        });
        // temperature data
        $(temperature_table).bootstrapTable({
            classes: 'table',
            url: 'https://firewhere-backend.herokuapp.com/api/gettemperature'
        });
        // season data
        $(season_table).bootstrapTable({
            classes: 'table',
            url: 'https://firewhere-backend.herokuapp.com/api/getseason'
        });
    </script>

    <!-- jQuery -->
    <script src="jquery-2.0.0.min.js"></script>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Bootstrap table -->
    <link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.18.3/dist/bootstrap-table.min.css">
    <script src="https://unpkg.com/bootstrap-table@1.18.3/dist/bootstrap-table.min.js"></script>
    <!-- bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4"
        crossorigin="anonymous"></script>
    <!-- Google Map API -->
    <script
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAtbKIID5sZzw5lu7otU960DnXQzwtGkG4&callback=initMap&libraries=&v=weekly"
        async></script>
    <!-- Google Map -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
    <script src="env.js"></script>
    <!-- socket IO Served by the server -->

    <script>
        socket.on('usercnt', function (msg) {
            document.getElementById("count").innerHTML = msg;
        })
    </script>
</body>

</html>